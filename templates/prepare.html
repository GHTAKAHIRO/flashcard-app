<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç¿’é€²æ— - {{ source }}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --locked-gradient: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .hero-section {
            background: var(--primary-gradient);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }

        .current-settings {
            background: rgba(255,255,255,0.15);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stage-card {
            border: none;
            border-radius: 15px;  /* ğŸ”¥ 20px â†’ 15px ã«å¤‰æ›´ */
            margin-bottom: 1rem;  /* ğŸ”¥ 2rem â†’ 1rem ã«å¤‰æ›´ */
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);  /* ğŸ”¥ å½±ã‚’å°ã•ã */
            background: white;
        }
        
        .stage-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .stage-header {
            background: var(--primary-gradient);
            color: white;
            padding: 1.2rem 1.5rem;  /* ğŸ”¥ 2rem 2.5rem â†’ 1.2rem 1.5rem ã«å¤‰æ›´ */
            position: relative;
            overflow: hidden;
        }

        .stage-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        
        .stage-completed .stage-header {
            background: var(--success-gradient);
        }
        
        .stage-locked .stage-header {
            background: var(--locked-gradient);
        }
        
        .stage-title {
            font-size: 1.4rem;  /* ğŸ”¥ 1.8rem â†’ 1.4rem ã«å¤‰æ›´ */
            font-weight: 700;
            margin-bottom: 0.3rem;  /* ğŸ”¥ 0.5rem â†’ 0.3rem ã«å¤‰æ›´ */
            display: flex;
            align-items: center;
            gap: 0.75rem;  /* ğŸ”¥ 1rem â†’ 0.75rem ã«å¤‰æ›´ */
        }

        .stage-stats {
            font-size: 0.85rem;  /* ğŸ”¥ 1rem â†’ 0.85rem ã«å¤‰æ›´ */
            opacity: 0.9;
            margin-bottom: 0.75rem;  /* ğŸ”¥ 1.5rem â†’ 0.75rem ã«å¤‰æ›´ */
        }

        .stage-progress-summary {
            background: rgba(255,255,255,0.15);
            padding: 0.6rem 1rem;  /* ğŸ”¥ 1rem 1.5rem â†’ 0.6rem 1rem ã«å¤‰æ›´ */
            border-radius: 8px;    /* ğŸ”¥ 12px â†’ 8px ã«å¤‰æ›´ */
            backdrop-filter: blur(10px);
        }

        .progress-bar-modern {
            height: 8px;     /* ğŸ”¥ 12px â†’ 8px ã«å¤‰æ›´ */
            border-radius: 4px;
            overflow: hidden;
            background-color: rgba(255,255,255,0.3);
            position: relative;
        }
        
        .progress-fill-modern {
            height: 100%;
            background: linear-gradient(90deg, #fff, rgba(255,255,255,0.8));
            transition: width 0.8s ease;
            border-radius: 4px;  /* ğŸ”¥ 6px â†’ 4px ã«å¤‰æ›´ */
            position: relative;
            overflow: hidden;
        }

        .progress-fill-modern::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .chunk-grid {
            padding: 1rem;      /* ğŸ”¥ 2rem â†’ 1rem ã«å¤‰æ›´ */
            display: grid;
            gap: 0.75rem;       /* ğŸ”¥ 1.5rem â†’ 0.75rem ã«å¤‰æ›´ */
        }

        .chunk-card {
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 1rem 1.5rem;  /* ğŸ”¥ padding ã‚’ 1.5rem â†’ 1rem 1.5rem ã«å¤‰æ›´ */
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .chunk-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .chunk-card:hover::before {
            left: 100%;
        }
        
        .chunk-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }
        
        .chunk-completed {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: #28a745;
        }
        
        .chunk-locked {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-color: #dc3545;
            opacity: 0.7;
        }

        .chunk-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;  /* ğŸ”¥ margin-bottom ã‚’ 1rem â†’ 0.75rem ã«å¤‰æ›´ */
        }
        
        .chunk-icon {
            width: 50px;   /* ğŸ”¥ 60px â†’ 50px ã«å¤‰æ›´ */
            height: 50px;  /* ğŸ”¥ 60px â†’ 50px ã«å¤‰æ›´ */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin-right: 1rem;
            font-size: 1.1rem;  /* ğŸ”¥ 1.2rem â†’ 1.1rem ã«å¤‰æ›´ */
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .chunk-active .chunk-icon {
            background: var(--primary-gradient);
        }
        
        .chunk-completed .chunk-icon {
            background: var(--success-gradient);
        }
        
        .chunk-locked .chunk-icon {
            background: var(--locked-gradient);
        }

        .chunk-info h5 {
            margin: 0;
            font-size: 1.2rem;  /* ğŸ”¥ 1.3rem â†’ 1.2rem ã«å¤‰æ›´ */
            font-weight: 600;
            color: #343a40;
        }

        .chunk-stats {
            color: #6c757d;
            font-size: 0.8rem;     /* ğŸ”¥ 0.9rem â†’ 0.8rem ã«å¤‰æ›´ */
            margin-top: 0.2rem;    /* ğŸ”¥ 0.25rem â†’ 0.2rem ã«å¤‰æ›´ */
        }

        .status-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;  /* ğŸ”¥ 0.5rem â†’ 0.4rem ã«å¤‰æ›´ */
            margin: 0.75rem 0;  /* ğŸ”¥ 1rem 0 â†’ 0.75rem 0 ã«å¤‰æ›´ */
        }
        
        .status-badge {
            padding: 0.4rem 0.8rem;  /* ğŸ”¥ 0.5rem 1rem â†’ 0.4rem 0.8rem ã«å¤‰æ›´ */
            border-radius: 20px;  /* ğŸ”¥ 25px â†’ 20px ã«å¤‰æ›´ */
            font-size: 0.8rem;    /* ğŸ”¥ 0.85rem â†’ 0.8rem ã«å¤‰æ›´ */
            font-weight: 600;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.4rem;  /* ğŸ”¥ 0.5rem â†’ 0.4rem ã«å¤‰æ›´ */
            transition: all 0.3s ease;
        }

        .status-badge:hover {
            transform: scale(1.05);
        }
        
        .status-completed {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #28a745;
        }
        
        .status-in-progress {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            border: 2px solid #ffc107;
        }
        
        .status-locked {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .action-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            justify-content: flex-end;
        }
        
        .btn-modern {
            padding: 0.6rem 1.2rem;  /* ğŸ”¥ 0.75rem 1.5rem â†’ 0.6rem 1.2rem ã«å¤‰æ›´ */
            border-radius: 20px;     /* ğŸ”¥ 25px â†’ 20px ã«å¤‰æ›´ */
            font-weight: 600;
            font-size: 0.85rem;     /* ğŸ”¥ 0.9rem â†’ 0.85rem ã«å¤‰æ›´ */
            transition: all 0.3s ease;
            border: none;
            position: relative;
            overflow: hidden;
            min-width: 100px;       /* ğŸ”¥ 120px â†’ 100px ã«å¤‰æ›´ */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;           /* ğŸ”¥ 0.5rem â†’ 0.4rem ã«å¤‰æ›´ */
        }

        .btn-modern::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }

        .btn-modern:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary-modern {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-success-modern {
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
        }

        .btn-success-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(17, 153, 142, 0.4);
        }

        .btn-outline-modern {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-outline-modern:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .btn-disabled-modern {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* ğŸ”¥ è©³ç´°çµ±è¨ˆã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  */
        .chunk-stats-detail {
            font-size: 0.7rem;
            color: #6c757d;
            padding-top: 0.4rem;
            margin-top: 0.4rem;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .locked-message {
            text-align: center;
            padding: 3rem 2rem;
            color: #6c757d;
        }

        .locked-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .tips-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            text-align: center;
        }

        .tips-icon {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .chunk-grid {
                padding: 1rem;
            }

            .chunk-card {
                padding: 1rem;
            }

            .action-buttons {
                justify-content: center;
            }

            .btn-modern {
                min-width: 100px;
                font-size: 0.8rem;
                padding: 0.6rem 1.2rem;
            }

            .status-badges {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="hero-title">
                        <i class="fas fa-graduation-cap"></i>
                        {{ source }} å­¦ç¿’é€²æ—
                    </h1>
                    <p class="hero-subtitle">ãƒãƒ£ãƒ³ã‚¯å˜ä½ã§åŠ¹ç‡ã‚ˆãå­¦ç¿’ã‚’é€²ã‚ã¾ã—ã‚‡ã†</p>
                </div>
                <div class="col-lg-4">
                    <div class="current-settings">
                        <div class="text-center mb-2">
                            <span><i class="fas fa-lock"></i> å­¦ç¿’è¨­å®šï¼ˆå›ºå®šï¼‰</span>
                        </div>
                        <div class="small text-center">
                            <div><strong>ãƒšãƒ¼ã‚¸ç¯„å›²:</strong> {{ saved_page_range or 'æœªè¨­å®š' }}</div>
                            <div><strong>é›£æ˜“åº¦:</strong> {{ saved_difficulty or 'æœªè¨­å®š' }}</div>
                        </div>
                        {% if not saved_page_range %}
                        <div class="text-center mt-2">
                            <a href="{{ url_for('dashboard') }}" class="btn btn-sm btn-warning">
                                <i class="fas fa-exclamation-triangle"></i> è¨­å®šãŒå¿…è¦ã§ã™
                            </a>
                        </div>
                        {% else %}
                        <div class="text-center mt-2">
                            <small class="text-muted">
                                <i class="fas fa-info-circle"></i> å­¦ç¿’é–‹å§‹å¾Œã¯å¤‰æ›´ä¸å¯
                            </small>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col">
                    <a href="{{ url_for('dashboard') }}" class="btn btn-outline-light">
                        <i class="fas fa-arrow-left"></i> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- ã‚¹ãƒ†ãƒ¼ã‚¸ä¸€è¦§ï¼ˆè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯å®Œå…¨ã«å‰Šé™¤æ¸ˆã¿ï¼‰ -->
        {% for stage_info in stages_info %}
        <div class="stage-card {% if stage_info.stage_completed %}stage-completed{% elif not stage_info.can_start %}stage-locked{% endif %}">
            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
            <div class="stage-header">
                <div class="stage-title">
                    {% if stage_info.stage_completed %}
                        <i class="fas fa-check-circle fa-2x"></i>
                    {% elif not stage_info.can_start %}
                        <i class="fas fa-lock fa-2x"></i>
                    {% else %}
                        <i class="fas fa-play-circle fa-2x"></i>
                    {% endif %}
                    <div>
                        {{ stage_info.stage_name }}
                        <div class="stage-stats">{{ stage_info.total_cards }}å• / {{ stage_info.total_chunks }}ãƒãƒ£ãƒ³ã‚¯</div>
                    </div>
                </div>
                
                <div class="text-end">
                    {% if stage_info.stage_completed %}
                        <span class="badge bg-light text-success fs-5 px-3 py-2">
                            <i class="fas fa-trophy"></i> å®Œäº†
                        </span>
                    {% elif not stage_info.can_start %}
                        <span class="badge bg-secondary fs-5 px-3 py-2">
                            <i class="fas fa-lock"></i> ãƒ­ãƒƒã‚¯ä¸­
                        </span>
                    {% else %}
                        <span class="badge bg-warning text-dark fs-5 px-3 py-2">
                            <i class="fas fa-clock"></i> é€²è¡Œä¸­
                        </span>
                    {% endif %}
                </div>
                
                <!-- é€²æ—ãƒãƒ¼ -->
                {% if stage_info.can_start or stage_info.stage_completed %}
                <div class="stage-progress-summary mt-3">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="progress-bar-modern">
                                {% set completed_chunks = stage_info.chunks_progress | selectattr('chunk_completed', 'equalto', true) | list | length %}
                                {% set progress_percent = (completed_chunks / stage_info.total_chunks * 100) | round | int %}
                                <div class="progress-fill-modern" style="width: {{ progress_percent }}%"></div>
                            </div>
                        </div>
                        <div class="col-md-4 text-md-end mt-2 mt-md-0">
                            <strong>{{ completed_chunks }} / {{ stage_info.total_chunks }} ãƒãƒ£ãƒ³ã‚¯å®Œäº†</strong>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§ -->
            {% if stage_info.can_start or stage_info.stage_completed %}
            <div class="chunk-grid">
                {% for chunk in stage_info.chunks_progress %}
                <div class="chunk-card {% if chunk.chunk_completed %}chunk-completed{% elif chunk.can_start_test %}chunk-active{% else %}chunk-locked{% endif %}">
                    
                    <div class="chunk-header">
                        <div class="chunk-icon">
                            {{ chunk.chunk_number }}
                        </div>
                        <div class="chunk-info">
                            <h5>ãƒãƒ£ãƒ³ã‚¯ {{ chunk.chunk_number }}</h5>
                            <div class="chunk-stats">{{ chunk.total_cards }}å•</div>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ -->
                    <div class="status-badges">
                        <!-- ãƒ†ã‚¹ãƒˆçŠ¶æ³ -->
                        {% if chunk.test_completed %}
                            <span class="status-badge status-completed">
                                <i class="fas fa-check"></i> ãƒ†ã‚¹ãƒˆå®Œäº†
                            </span>
                        {% elif chunk.can_start_test %}
                            <span class="status-badge status-in-progress">
                                <i class="fas fa-clock"></i> ãƒ†ã‚¹ãƒˆå¯èƒ½
                            </span>
                        {% else %}
                            <span class="status-badge status-locked">
                                <i class="fas fa-lock"></i> ãƒ†ã‚¹ãƒˆå¾…æ©Ÿ
                            </span>
                        {% endif %}

                        <!-- ç·´ç¿’çŠ¶æ³ï¼ˆÃ—å•é¡ŒãŒã‚ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰ -->
                        {% if chunk.practice_needed %}
                            {% if chunk.practice_completed %}
                                <span class="status-badge status-completed">
                                    <i class="fas fa-dumbbell"></i> ç·´ç¿’å®Œäº†
                                </span>
                            {% elif chunk.can_start_practice %}
                                <span class="status-badge status-in-progress">
                                    <i class="fas fa-dumbbell"></i> ç·´ç¿’å¯èƒ½
                                </span>
                            {% else %}
                                <span class="status-badge status-locked">
                                    <i class="fas fa-lock"></i> ç·´ç¿’å¾…æ©Ÿ
                                </span>
                            {% endif %}
                        {% endif %}
                    </div>
                    
                    <!-- è©³ç´°çµ±è¨ˆ -->
                    {% if chunk.test_completed %}
                    <div class="chunk-stats mb-2">  <!-- ğŸ”¥ mb-3 â†’ mb-2 ã«å¤‰æ›´ -->
                        <i class="fas fa-chart-pie text-primary"></i>
                        æ­£è§£: <span class="text-success fw-bold">{{ chunk.test_correct }}å•</span>
                        {% if chunk.test_wrong > 0 %}
                            / é–“é•ã„: <span class="text-danger fw-bold">{{ chunk.test_wrong }}å•</span>
                        {% else %}
                            / <span class="text-success fw-bold">å…¨å•æ­£è§£ï¼</span>
                        {% endif %}
                    </div>
                    {% endif %}

                    <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                    <div class="action-buttons">
                        <!-- ãƒ†ã‚¹ãƒˆãƒœã‚¿ãƒ³ -->
                        {% if chunk.can_start_test and not chunk.test_completed %}
                            <a href="{{ url_for('start_chunk', source=source, stage=stage_info.stage, chunk_number=chunk.chunk_number, mode='test') }}" 
                               class="btn btn-primary-modern btn-modern">
                                <i class="fas fa-play"></i> ãƒ†ã‚¹ãƒˆé–‹å§‹
                            </a>
                        {% elif chunk.test_completed %}
                            <button class="btn btn-disabled-modern btn-modern" disabled>
                                <i class="fas fa-check"></i> ãƒ†ã‚¹ãƒˆå®Œäº†
                            </button>
                        {% else %}
                            <button class="btn btn-disabled-modern btn-modern" disabled>
                                <i class="fas fa-lock"></i> ãƒ†ã‚¹ãƒˆ
                            </button>
                        {% endif %}

                        <!-- ç·´ç¿’ãƒœã‚¿ãƒ³ï¼ˆÃ—å•é¡ŒãŒã‚ã‚‹å ´åˆã®ã¿è¡¨ç¤ºï¼‰ -->
                        {% if chunk.practice_needed %}
                            {% if chunk.can_start_practice %}
                                {% if chunk.practice_completed %}
                                    <a href="{{ url_for('start_chunk', source=source, stage=stage_info.stage, chunk_number=chunk.chunk_number, mode='practice') }}" 
                                       class="btn btn-outline-modern btn-modern">
                                        <i class="fas fa-redo"></i> å†ç·´ç¿’
                                    </a>
                                {% else %}
                                    <a href="{{ url_for('start_chunk', source=source, stage=stage_info.stage, chunk_number=chunk.chunk_number, mode='practice') }}" 
                                       class="btn btn-success-modern btn-modern">
                                        <i class="fas fa-dumbbell"></i> ç·´ç¿’é–‹å§‹
                                    </a>
                                {% endif %}
                            {% else %}
                                <button class="btn btn-disabled-modern btn-modern" disabled>
                                    <i class="fas fa-lock"></i> ç·´ç¿’
                                </button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <!-- ãƒ­ãƒƒã‚¯ä¸­ã®è¡¨ç¤º -->
            <div class="locked-message">
                <div class="locked-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h5>å‰ã®ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’å®Œäº†ã™ã‚‹ã¨åˆ©ç”¨ã§ãã¾ã™</h5>
                <p class="mb-0">ã‚¹ãƒ†ãƒ¼ã‚¸ã¯é †ç•ªã«é€²ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</p>
            </div>
            {% endif %}
        </div>
        {% endfor %}

        <!-- å­¦ç¿’ã®ã‚³ãƒ„ -->
        <div class="tips-section">
            <div class="tips-icon">
                <i class="fas fa-lightbulb"></i>
            </div>
            <h6 class="text-primary mb-3">å­¦ç¿’ã®ã‚³ãƒ„</h6>
            <p class="mb-0 text-muted">
                å„ãƒãƒ£ãƒ³ã‚¯ã®ãƒ†ã‚¹ãƒˆã‚’å®Œäº†å¾Œã€é–“é•ãˆãŸå•é¡Œã‚’ç·´ç¿’ã—ã¦ã‹ã‚‰ã‚¹ãƒ†ãƒ¼ã‚¸å®Œäº†ã§ã™ã€‚<br>
                ãƒãƒ£ãƒ³ã‚¯å˜ä½ã§ç¢ºå®Ÿã«ç†è§£ã‚’æ·±ã‚ã¦ã„ãã¾ã—ã‚‡ã†ï¼
            </p>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- ã‚«ã‚¹ã‚¿ãƒ JS -->
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        document.addEventListener('DOMContentLoaded', function() {
            const stageCards = document.querySelectorAll('.stage-card');
            stageCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 150);
            });

            // ãƒãƒ£ãƒ³ã‚¯ã‚«ãƒ¼ãƒ‰ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            setTimeout(() => {
                const chunkCards = document.querySelectorAll('.chunk-card');
                chunkCards.forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'scale(0.9)';
                    
                    setTimeout(() => {
                        card.style.transition = 'all 0.4s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'scale(1)';
                    }, index * 100);
                });
            }, 300);
        });

        // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ç¢ºèªã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
        document.querySelectorAll('.btn-modern').forEach(button => {
            button.addEventListener('click', function(e) {
                if (this.textContent.includes('ãƒ†ã‚¹ãƒˆé–‹å§‹') || this.textContent.includes('ç·´ç¿’é–‹å§‹')) {
                    const confirmation = confirm('å­¦ç¿’ã‚’é–‹å§‹ã—ã¾ã™ã‹ï¼Ÿ');
                    if (!confirmation) {
                        e.preventDefault();
                        return;
                    }
                    
                    // ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                }
            });
        });

        // é€²æ—ãƒãƒ¼ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        setTimeout(() => {
            document.querySelectorAll('.progress-fill-modern').forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, 200);
            });
        }, 800);

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ã®ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        document.querySelectorAll('.status-badge').forEach(badge => {
            badge.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05) rotate(1deg)';
            });
            
            badge.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1) rotate(0deg)';
            });
        });
    </script>
</body>
</html>